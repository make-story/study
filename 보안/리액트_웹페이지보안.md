# 웹사이트 보안을 위한 리액트와 웹페이지 보안 이슈

`모던 리액트 Deep Dive` 책 내용 중 - 14장, p875

## dangerouslySetInnerHTML prop

https://ko.legacy.reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml

dangerouslySetInnerHTML 은 이름에서 알 수 있듯이 특정 브라우저 DOM 의 innerHTML 을 특정한 내용으로 교체할 수 있는 방법이다.

```jsx
function createMarkup() {
  return { __html: 'First &middot; Second' };
}

function MyComponent() {
  return <div dangerouslySetInnerHTML={createMarkup()} />;
}
```

dangerouslySetInnerHTML 은 오직 \_\_html 를 키로 가지고 있는 객체만 인수로 받을 수 있으며,  
이 인수로 넘겨 받은 문자열을 DOM 에 그대로 표시하는 역할을 한다.

그러나 `이 dangerouslySetInnerHTML 의 위험성은 dangerouslySetInnerHTML 이 인수로 받은 문자열에는 제한이 없다는 것이다.`

## useRef 를 활용한 직접 삽입

dangerouslySetInnerHTML 과 비슷한 방법으로 DOM 에 직접 내용을 삽입할 수 있는 방법으로 useRef 가 있다.  
useRef 를 활용하면 직접 DOM 에 접근할 수 있으므로 이 DOM 의 innerHTML 을 통해 보안 취약점이 있는 스크립트를 합입하면 동일한 문제가 발생한다.

## 리액트에서 XSS (크로스 사이트 스크립팅, Cross-Site Scripting) 문제를 피하는 방법

제 3자가 삽입할 수 있는 HTML 을 안전한 HTML 코드로 한 번 치환하는 것이다.

`이러한 과정을 새니타이즈(sanitize) 또는 이스케이프(escape)` 라고 하는데,  
새니타이즈를 직접 구현해 사용하는 등 다양한 방법이 있지만 가장 확실한 방법은 npm 에 있는 라이브러리를 사용하는 것이다.

- DOMpurity
- sanitize-html
- js-xss

## getServerSideProps 와 서버 컴포넌트를 주의하자

서버에는 일반 사용자에게 노출되면 안 되는 정보들이 담겨 있기 때문에 클라이언트, 즉 브라우저에 정보를 넘겨줄 때는 조심해야 한다.

## <a> 태그의 값에 적절한 제한을 둬야 한다

웹 개발 시에 <a> 태그의 href 에 javascript: 로 시작하는 자바스크립트 코드를 넣어둔 경우를 본 적이 있을 것이다.  
이는 주로 <a> 태그의 기본 기능, 즉 href 로 선언된 URL 로 페이지를 이동하는 것을 막고 onClick 이벤트와 같이 별도 이벤트 핸들러만 작동시키기 위한 용도로 주요 사용된다.

이러한 방식은 마크업 관점에서 또한 안티패턴으로 볼 수 있다.  
<a> 태그는 반드시 페이지 이동이 있을 때만 사용하는 것이 좋다.  
페이지 이동이 없이 어떠한 핸들러만 작동시키고 싶다면 <a> 보다는 button 을 사용하는 것이 좋다.
