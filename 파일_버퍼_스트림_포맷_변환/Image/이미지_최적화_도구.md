# sharp VS Squoosh

https://oliveyoung.tech/blog/2023-06-09/nextjs-image-optimization/

NEXT.JS는 운영 환경에서는 sharp 라이브러리를 사용할 것은 권장하고 있습니다.

https://nextjs.org/docs/messages/sharp-missing-in-production

sharp? Squoosh?

NEXT.JS는 Squoosh를 기본 이미지 최적화 모듈로 사용하고 있고, Squoosh는 빠르게 설치할 수 있고 개발 환경에 적합하다고 합니다.  
그런데, `운영 환경에서는 sharp를 사용하는 것을 매우 강력하게 권장`하고 있습니다.

`sharp를 사용하면 Squoosh를 사용할 때와 비교하면 WebP 포맷으로 최적화할 때는 3~4배, AVIF 포맷으로 최적화할 때는 3~6배 정도의 성능 개선이 있다.`

## sharp

https://github.com/lovell/sharp

다양한 크기의 JPEG, PNG, WebP, GIF, AVIF와 같은 이미지들을 더 작은 크기로, 그리고 웹에 진화적으로 변환해 주는 매우 빠른 속도의 모듈이라고 설명하고 있습니다.

## Squoosh

https://github.com/GoogleChromeLabs/squoosh

sharp 페이지에 비하면 매우 단순합니다. 내용도 sharp와 비슷하게 다양한 포맷의 이미지를 압축하고 사이즈를 줄여준다고 합니다.

## 성능비교

https://oliveyoung.tech/blog/2023-06-09/nextjs-image-optimization/

1. PNG -> WebP 변환

원본은 1.9MB의 이미지 파일입니다.

이미지 크기를 비교했을 때, Squoosh는 17.1KB로, sharp는 16.9KB로 크기를 감소했습니다.

크기를 비교했을 때는 큰 차이가 없지만, 응답속도를 비교한다면 Squoosh는 228ms, sharp는 64ms입니다.  
sharp를 사용했을 때 약 3~4배 정도로 빠르게 응답을 줬습니다.

2. PNG -> AVIF 변환

원본은 1.9MB의 이미지 파일입니다.

이미지 크기를 비교했을 때, Squoosh는 10.8KB로, sharp는 13.1KB로 크기를 감소했습니다.

이번에도 크기를 비교했을 때는 큰 차이가 없지만, 응답속도를 비교한다면 Squoosh는 1.24s, sharp는 202ms 입니다.  
sharp를 사용했을 때 약 6배 정도로 빠르게 응답을 줬습니다.

이 정도의 속도 차이가 난다면, sharp를 사용하지 않을 이유가 없을 것 같습니다.
