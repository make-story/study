https://yceffort.kr/2021/03/improve-css-performance

# CSS 압축하고 최소화 하기

...

# 사용하지 않는 CSS 제거

CSS-in-JS를 쓸 때 얻을 수 있는 가장 큰 이점이다.  
각 컴포넌트가 렌더링에 필요한 CSS가 js내에 포함되어 있다.  
(따라서 컴포넌트 레벨로 관리하기 때문에 편하다는 것)  
CSS-in-JS는 페이지 내부에 CSS를 인라인 처리하거나,  
외부 CSS파일로 따로 번들링 해버린다.  
CSS를 자바스크립트 내부에 포함시켜 버리면 CSS 파싱과 평가가 느려진다.

# CSS의 우선순위 정하기

Critical CSS란 화면에 보이는 컨텐츠 (above-the-fold content)의 CSS 에 대해서만 inline 처리하는 것을 의미한다.

# CSS 비동기로 불러오기

```html
<link
  rel="stylesheet"
  href="non-critical.css"
  media="print"
  onload="this.media='all'"
/>
```

또 다른 방법은 <link rel="preload">를 사용하는 것이다.

# @import 사용하면 성능저하?

https://mytory.net/archives/15418

`@import냐, <link>냐, 하나로 모두 합친 CSS냐는 렌더링 성능(시작 이나 완료 시간)에 영향을 주지 않습니다.`

즉, `렌더링 성능에 영향을 미치는 요소는 CSS의 용량과 적용 시점입니다.`  
CSS가 별도 조처 없이 들어가 있는 한, 렌더링은 CSS가 모두 다운로드된 다음에 시작됩니다(크롬, 엣지, 파이어폭스, 사파리 공통).  
`CSS 파일의 용량이 같고, 별도 처리해 CSS가 비동기적으로 적용되게 하지 않는다면 @import를 하든 <link>를 여러 개 하든, 한 파일로 합치든 렌더링 시작 시점은 별 차이가 없었습니다.`

따라서 `렌더링 성능을 높이려면 CSS의 용량을 줄이는 것이 가장 효과적입니다.`

CSS 용량을 당장 줄이기 힘들 때 체감 성능을 높이는 방법은 코어 CSS를 <head> 영역에 넣고 나머지를 비동기로 로딩하는 것입니다. 이러면 체감 성능을 높일 수 있습니다.

`그런데 비동기 로딩 방식을 쓰는 것은 꼭 선택하지 않아도 된다는 생각입니다. 개발 효율 때문인데요.`

코어 CSS를 고르는 방법을 자동화하는 게 관건일 텐데 이게 시간이 꽤 들 것 같거든요(구글 Lighthouse 테스트 결과에서는 자동화된 툴(addyosmani/critical)을 소개해 주지만 꽤 오래된 툴입니다).  
버그도 많이 유발할 것 같고요.

그래서 들이는 노력 대비 효과가 클지 모르겠습니다. 아무리 큰 CSS도 압축 전송하면 1MB 미만이고, 제가 관리하는 사이트는 25.5KB밖에 안 됩니다. 이걸 위해서 커다란 노력을 들이는 게 저로선 효과적이란 생각이 들진 않습니다. 사용자가 엄청나게 많고 CSS 용량이 꽤 나가는 사이트라면 시도해 볼만 하겠지요.

그냥 일반으로 CSS 용량을 줄이는 게 더 편리한 접근이 아닐까 생각합니다.
