# Lerna, Nx, Turborepo, 러쉬(Rush) 스택

https://d2.naver.com/helloworld/7553804#ch4

https://doong-jo.github.io/posts/long-live-monorepos/

---

# Lerna

npm, yarn 및 pnpm과 같은 도구는 모노레포를 자체적으로 지원합니다.  
그러나 몇가지 필요한 기능을 지원하지 않아 아쉬움이 있었습니다.  
이러한 부족함을 Lerna에서는 지원했습니다.  
Lerna의 목표는 패키지를 빌드, 조정 및 배포할 수 있도록 확장성을 향상시키는 것이었습니다.

https://github.com/lerna/lerna/issues/2703

Lerna는 최근에 공식적으로 수명이 다했습니다.  
비록 메인테이너였던 @evocateur가 그의 번아웃과 함께 프로젝트를 포기하려는 의도를 밝혔지만, 그것은 2020년 4월까지 공식화되지 않았었습니다.

---

# `Nx`

---

## TurboRepo로 monorepo 환경 구성

https://github.com/vercel/turbo/tree/main/examples/basic

https://engineering.linecorp.com/ko/blog/monorepo-with-turborepo#1

https://github.com/KimHunJin/turbo-repo-test

## 프로젝트 생성

```
$ yarn init
```

## vercel 추가

```
$ yarn add turbo -W --dev
```

`-W 옵션`
https://classic.yarnpkg.com/lang/en/docs/cli/add/#toc-yarn-add-ignore-workspace-root-check-w
작업 공간 루트에 설치

`--dev 옵션`
https://classic.yarnpkg.com/lang/en/docs/cli/add/#toc-yarn-add-dev-d  
devDependencies 에 추가됨

## 필요한 폴더 구축

```
$ mkdir apps
$ mkdir packages
```

- apps 에는 보통 실제로 화면을 구성하기 위한 페이지들의 프로젝트 폴더
- packages 에는 각종 util이나 config 파일 그리고 library처럼 쓸 수 있는 컴포넌트들로 구성

```
$ cd apps
$ mkdir admin
$ mkdir client

$ cd packages
$ mkdir components
$ mkdir tsconfig
```

## Next.js 및 typescript 환경 구성

next.js에 사용할 tsconfig에 대한 환경을 구성

```
$ cd tsconfig
$ vi base.json
```

```json
{
  "$schema": "https://json.schemastore.org/tsconfig",
  "display": "Default",
  "compilerOptions": {
    "composite": false,
    "declaration": true,
    "declarationMap": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "inlineSources": false,
    "isolatedModules": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "preserveWatchOutput": true,
    "skipLibCheck": true,
    "strict": true
  },
  "exclude": ["node_modules"]
}
```

```
$ vi package.json
```

```json
{
  "name": "tsconfig",
  "version": "0.0.0",
  "private": true,
  "main": "index.js",
  "files": ["base.json", "nextjs.json", "react-library.json"]
}
```
