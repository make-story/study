# Node.js 특징

## 이벤트 기반

- 이벤트 기반(Event-driven)이란 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식을 의미한다.
- 즉, 이벤트 기반 시스템에서는 특정 이벤트가 발생할 때 무엇을 할지 미리 등록해두고, 이를 이벤트 리스너에 콜백함수를 등록한다.
- 이후 이벤트가 발생하면 리스너에 등록해둔 콜백함수를 호출하며, 이벤트가 끝난 후 노드는 다음 이벤트가 발생할 때까지 대기한다.

## 이벤트 루프

- 이벤트 루프(event loop)는 여러 이벤트가 동시에 발생했을 때 어떤 순서로 콜백함수를 호출 할지를 이벤트 루프가 판단한다.
- 노드는 이벤트가 종료될 때까지 이벤트 처리를 위한 작업을 반복하므로 루프(loog)라고 부른다.

## 논 블로킹 I/O

- 작업에는 두 가지 종류가 있는데 동시에 실행될 수 있는 작업과 동시에 실행될 수 없는 작업이다.
- 특히 파일 시스템 접근, 네트워크를 통한 요청 작업은 입력(Input)/출력(Output)의 일종이며,
- 이러한 작업을 할 때 `노드는 비동기 방식으로 블로킹을 만들지 않게 끔(논 블로킹) 처리`한다.
- 비동기이란 이전 작업이 완료될 때까지 대기하지 않고 동시에 작업을 수행한다.
- 반대로 동기는 이전 작업이 끝나야만 다음 작업을 수행한다.

## 싱글 스레드

이벤트 기반, 논 블로킹 모델과 더불어 노드를 설명하는 키워드 중 하나는 싱글 스레드이다.
자바스크립트 코드는 동시에 실행될 수 없는데 그 이유는 노드가 싱글 스레드 기반이기 때문이다.

- 프로세스
  운영체제에서 할당하는 작업의 단위이다. 노드나 웹 브라우저 같은 프로그램은 개별적인 프로세스이다. 프로세스 간에는 메모리 등의 자원을 공유하지 않는다.
- 스레드
  스레드는 프로세스 내에서 실행되는 흐름의 단위이다. 프로세스는 스레드를 여러 개 생성해 여러 작업을 동시에 처리할 수 있다. 스레드들은 부모 프로세스의 자원을 공유한다. 같은 주소의 메모리에 접근 가능하므로 데이터를 공유할 수 있다.

`Node.js는 싱글스레드, 논 블로킹 모델로 싱글 스레드가 혼자서 일을 처리하지만 들어오는 요청 순서가 아닌 논 블로킹 방식으로 이전 작업이 완료될 때까지 대기하지 않고 다음 작업을 수행한다.`

---

https://mygumi.tistory.com/154

# 멀티 스레드 기반의 HTTP 요청/응답 모델 (Spring + JSP)

- 클라이언트는 웹 서버에게 요청을 보낸다.
- 웹 서버는 내부적으로 제한된 스레드 풀을 관리하여 클라이언트의 요청에 서비스를 제공한다.
- 웹 서버는 무한 루프에 있으며, 클라이언트의 요청을 기다리는 중이다.
- 웹 서버는 요청들을 받아들인다.
  - 웹 서버는 하나의 요청을 가져온다.
  - 스레드 풀로부터의 하나의 스레드에 가져온다.
  - 이 스레드에 요청이 할당된다.
  - 이 스레드가 요청을 읽고 처리한다. (요청 처리, Blocking I/O가 있다면 수행, 응답 준비)
  - 이 스레드는 준비된 응답을 다시 웹 서버에게 보낸다.
  - 웹 서버는 이 응답을 클라이언트에게 보낸다.

서버는 무한 루프에서 기다리고, 모든 클라이언트 요청을 위의 단계로 수행한다.
여기서는 하나의 요청이 하나의 스레드를 생성하는 것을 의미한다.

만약 많은 요청들이 Blocking I/O를 요구한다면, 거의 모든 스레드는 응답 준비중이다.
그 결과, 나머지 클라이언트 요청은 더 오랜 시간을 기다리게 된다.

## 멀티 스레드 구조의 단점

- 점점 더 많은 동시에 발생하는 클라이언트의 요청을 처리하는 것이 어렵다.
- 동시에 발생하는 클라이언트의 요청이 증가할 때, 많은 스레드를 이용해야하기 때문에 많은 메모리를 사용하게 된다.
- 때때로, 클라이언트의 요청은 사용 가능한 스레드가 요청을 처리할 때까지 기다려야한다.
- Blocking I/O 작업으로 인해 시간이 낭비된다.

# Node.js의 싱글 스레드 기반의 구조
