# 토큰 갱신 방안

1. 웹 페이지 Request 요청이 왔을 때, 서버사이드에서 토큰 만료시간이 가까줘 졌다면 갱신

- 토큰 갱신 후 갱신된 값으로 웹 페이지 반환
- 이 경우 웹페이지 최초 로드간 비동기 호출 API에 대해 토큰갱신이 일어나지 않아서 안정적임

2. 클라이언트 사이드(브라우저) 단에서 비동기 호출간 갱신이 필요한 경우

- axios 인터셉트 등에서 request 에 대한 대기열을 만들고,
- 갱신 후 갱신된 토큰값으로 헤더 변경하여 API 호출!
- 클라이언트단에서 인터셉트로 전역변수 대기열 배열을 만들 경우, 서버사이드에 비히 메모리릭 발생확률 적음

3. 웹뷰에서의 경우!

- 토큰 갱신은 앱 또는 웹뷰 한곳에서만 일어나야한다.
  - 웹뷰에서 HTTP 요청시 유저에이전트 또는 x- 사용자 헤더값으로 웹뷰라는 사실을 서버사이드가 인지할 수 있도록 정보 추가
- 앱이 토큰을 관리하도록 한다.
  - 앱이 웹뷰의 HTTP Request 를 모니터링 하면서 토큰값 확인 (갱신된 값 주입 등)
