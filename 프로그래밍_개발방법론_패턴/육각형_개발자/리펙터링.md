# `육각형 개발자` 책 내용 중, 리팩터링 - 6장

## 수정 공포와 변경 비용 - p130

개발자는 왜 레거시에 부담을 느낄까?  
다음은 레거시에서 나타나는 흔한 특성이다.

- 긴 클래스, 긴 메서드 (코드 라인수)
- 복잡한 코드
- 이상한 이름
- 많은 중복
- 테스트 코드 없음

악순환은 개발 비용 증가로 이어진다.  
마치 공공장보에 떨어져 있는 쓰레기와 같다.  
공공장소의 모퉁이에 누군가가 음료 컵을 버렸다고 하자.  
이 쓰레기를 치우지 않으면 다른 사람도 같은 위치에 음료 컵을 버리기 시작한다.  
더 방치하면 담배꽁초 같은 다른 쓰레기도 추가된다.  
1개였던 쓰레기는 어느 순간 쓰레기 더미로 바뀐다.

쓰레기가 1~2개일 때 보다 쓰레기 더미를 치우는 게 힘들다.  
비슷하게 코드 덧대기가 쌓여 누더기가 된 코드는 수정이 힘들다.  
악순환이 지속될수록 코드 수정 비용은 점점 증가한다.

## 레거시는 폄하 대상이 아니다. - p133

가끔 레거시 코드를 무시하는 개발자를 만날 때가 있다.  
회사 코드가 최악이라거나 다시 만들면 그거보다 더 잘 만들 수 있다는 식으로 말이다.  
물론 틀린 말은 아닐 수도 있지만, 이런 말을 하는 개발자 중 기존 코드를 더 낫게 개선할 수 있는 사람은 많지 않았다.  
더 좋게 개선하지도 못하는데 새로 잘 만들 수 있을까?

복잡하고 수정하기 힘든 레거시 코드를 만나면 당연히 투덜댈 수 있다.  
하지만 레거시는 폄하 대상이 아니다.  
레거시가 있었기에 서비스가 굴러가고 수익이 난 것이다.  
그리고 모든 코드에는 나름의 사정이 있다. 그러니 레거시를 만나면 다음처럼 생각해보자.  
"개선할 거리가 있다. 해보자!"

## 리팩터링 - p134

리팩터링은 외부로 드러나는 동작이나 기능을 변경하지 않고 내부 구조를 변경해서 재구성하는 기법이다.  
리팩터링은 새로운 기능을 추가하거나 기존 기능을 개선하지 않는다.  
그래서 겉으로 드러나는 이점이 없다. 하지만 리팩터링을 하고 나면 장기적 관점에서 이점이 생긴다.  
코드 가독성이 높아지고 리팩터링 이전보다 구현 변경과 확장이 용이해진다.  
이러한 변화는 단기적으로는 수정 비용을 낮춰주고 장기적으로는 개발 비용을 줄여준다.

## 미사용 코드 삭제 - p135

가장 쉽지만 가장 부담되는 리팩터링이 코드 삭제다.  
삭제 대상이 될 수 있는 흔한 예가 주석 처리된 코드이다.

다음과 같은 이유로 주석 처리된 코드를 삭제하지 못하는 개발자가 많다.

- 왜 주석 처리했는지 몰라서...
- 나중에 다시 사용할지 몰라서...

이런 이유로 삭제하기 두렵다면 해당 코드에 TODO 주석을 추가하자.

```
// TODO 삭제 대상 2023-05-01 사용하지 않음
//anyCode()
```

## 이름에 코드 값 함께 쓰기 - p139

매직 넘버를 상수나 열거 타입으로 바꿔서 이름을 부여하면 의미가 잘 드러난다.  
그런데 코드를 분석하다 보면 "그래서 GAS(매직변수로 GAS 선언해서 사용중)의 실제 값은 뭐지?" 라는 생각이 들 때가 많다.  
그럴땐 선언 위치로 이동해서 값을 확인한다.  
개발 도구에 따라 이름에 마우스 커서를 갖다 대면 선언 내용을 보여주기도 한다.  
하지만 나는 이름의 실제 값을 보기 위해 추가 행위를 하는 게 귀찮았다.  
그래서 다음과 같이 이름 뒤에 실제 값을 포함해서 코드를 작성하기도 했다.

```
public enum BoilerType {
    GAS_19(19), INDUSTRIAL_20(20)
}
```

## 이름 짓기 (네이밍) - p141

단어를 고르는 데 어려움이 있다면 시간을 많이 낭비하지 말고 일단 당장 생각나는 단어를 사용해서 구현하자.  
대신 주석으로 어떤 의미인지 적어 놓으면 된다.  
`이후 더 나은 단어가 떠오르면 그때 이름을 바꾸는 리팩터링을 하자`

## 메서드를 추출할 때 주의할 점 - p143

`메서드 추출을 잘못하면 오히려 코드를 탐색하는 데 부담이 증가하고 가독성이 떨어지며 코드를 추적하기가 어려워질 수 있다.`  
`이런 증상이 나타나는 주된 이유는 메서드로 추출한 코드 블록이 개념적으로 구분되는 로직이 아니기 때문이다.`  
이럴 때는 일단 추출한 메서드를 인라인(inline)해서 원래 메서드로 다시 코드를 옮긴다.  
`그리고 코드를 분석해서 관련된 코드 묶음을 다시 찾아서 메서드로 추출해야 한다.`

## 리팩터링 vs 새로 만들기 - p159

새로 만든다고 코드가 좋아진다는 법은 없다.  
좋은 코드를 만드는 방법을 알아야 코드 품질이 좋아진다.  
이 사실을 꼭 기억하자.
